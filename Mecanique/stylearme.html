<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Style d'Arme et Armure</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div id="navbar-container"></div>
    <script src="../navbar.js"></script>

    <div class="content-wrapper">
        <div class="header">
            <h1>Style d'armes et armures</h1>
            <p>système de maitrise et expertise lié aux armes et armures</p>
        </div>

        <section class="tier-section" >
            <div style="display: flex; flex-wrap: wrap; align-items: flex-start; gap: 32px;">
                <div style="flex: 1 1 220px; min-width: 180px;">
                    <h2>Espadon</h2>
                    <br>
                    <p><b>Mot clef récurent :</b> <b class="data-passifs" data-passifs-name="Lourd"> Lourd</b>, Tranchant</p>
                    <br>
                    <p><b>Maitrise : </b></p> 
                    <ul>
                        <li data-ability="Charge"></li>
                    </ul>
                    
                    <br>
                    <p><b>Expertise : </b> </p>
                    <ul>
                        <li data-ability="Enchaînement Chargé"></li>
                    </ul>    
                    
                </div>
                <div style="flex: 1 1 180px; min-width: 140px; text-align: center;">
                    <img src="../img/espadon.jpg"
                        style="max-height: 280px; height: 100%; border-radius: 15px; box-shadow: 0 4px 16px rgba(0,0,0,0.15); margin-top: 12px;">
                </div>
            </div>
        </section>
        <section class="tier-section" >
            <div style="display: flex; flex-wrap: wrap; align-items: flex-start; gap: 32px;">                
                <div style="flex: 1 1 220px; min-width: 180px;">
                    <h2>Marteau de Guerre</h2>
                    <br>
                    <p><b>Mot clef récurent :</b> <b class="data-passifs" data-passifs-name="Extrêmement Lourd"> Extrêmement Lourd</b>, Contondant</p>
                    <br>
                    <p><b>Maitrise : </b></p> 
                    <ul>
                        <li data-ability="Frappe Étourdissante"></li>
                    </ul>
                    
                    <br>
                    <p><b>Expertise : </b> </p>
                    <ul>
                        <li data-ability="Destruction de défense"></li>
                    </ul>                       
                </div> 
                <div style="flex: 1 1 180px; min-width: 140px; text-align: center;">
                    <img src="../img/marteau.jpg"
                        style="max-height: 280px; height: 100%; border-radius: 15px; box-shadow: 0 4px 16px rgba(0,0,0,0.15); margin-top: 12px;">
                </div>               
            </div>
        </section>
        <section class="tier-section" >
            <h2>Katana et Faux</h2>
            <br>
            <p><b>Mot clef récurent :</b> <b class="data-passifs" data-passifs-name="Allonge"> Allonge</b>, <b class="data-passifs" data-passifs-name="Finesse"> Finesse</b>, Coupant</p>
            <br>
            <div style="display: flex; flex-wrap: wrap; align-items: flex-start; gap: 32px;">                
                <div style="flex: 1 1 220px; min-width: 180px;">
                    <p><b>Maitrise : </b></p> 
                    <ul>
                        <li data-ability="Changement de Posture - Action Bonus"></li>
                    </ul>
                    
                    <br>
                    <p><b>Expertise : </b> </p>
                    <ul>
                        <li data-ability="Changement de Posture Améliorée"></li>
                    </ul>                       
                </div> 
                <div style="flex: 1 1 180px; min-width: 140px; text-align: center;">
                    <img src="../img/katana.png"
                        style="max-height: 280px; height: 100%; margin-top: 24px;">
                </div>               
            </div>
        </section>
        <section class="tier-section" >
            <div style="display: flex; flex-wrap: wrap; align-items: flex-start; gap: 32px;">                
                <div style="flex: 1 1 220px; min-width: 180px;">
                    <h2>Hallebarde</h2>
                    <br>
                    <p><b>Mot clef récurent :</b> <b class="data-passifs" data-passifs-name="Allonge"> Allonge</b>, <b class="data-passifs" data-passifs-name="Finesse"> Finesse</b>, Perçant</p>
                    <br>
                    <p><b>Maitrise : </b></p> 
                    <ul>
                        <li data-ability="Empalement - Action + Action de Déplacement"></li>
                    </ul>
                    
                    <br>
                    <p><b>Expertise : </b> </p>
                    <ul>
                        <li data-ability="Repositionnement Tactique"></li>
                    </ul>                       
                </div> 
                <div style="flex: 1 1 180px; min-width: 140px; text-align: center;">
                    <img src="../img/hallebarde.png"
                        style="max-height: 380px; height: 100%; margin-top: 12px;">
                </div>               
            </div>
        </section>
        <section class="tier-section" >
            
            <div style="display: flex; flex-wrap: wrap; align-items: flex-start; gap: 32px;">            
                <div style="flex: 1 1 220px; min-width: 180px;">                   
                    <h2>Poings de fer</h2>
                    <br>
                    <p><b>Mot clef récurent :</b> <b class="data-passifs" data-passifs-name="Court"> Court</b>, <b class="data-passifs" data-passifs-name="Double"> Double</b>, Contondant</p>
                    <br> 
                    <p><b>Maitrise : </b></p> 
                    <ul>
                        <li data-ability="Saisie - Action Bonus"></li>
                        <li data-ability="Relâche - Action Bonus"></li>
                    </ul>
                    
                    <br>
                    <p><b>Expertise : </b> </p>
                    <ul>
                        <li data-ability="Triple Coups"></li>
                        <li data-ability="Projection"></li>
                    </ul>                       
                </div> 
                <div style="flex: 1 1 180px; min-width: 140px; text-align: center;">
                    <img src="../img/poingDeFer.png"
                        style="max-height: 380px; height: 100%; margin-top: 12px;">
                </div>               
            </div>
        </section>
        <section class="tier-section" >
            
            <div style="display: flex; flex-wrap: wrap; align-items: flex-start; gap: 32px;">            
                <div style="flex: 1 1 220px; min-width: 180px;">                   
                    <h2>Poings de fer</h2>
                    <br>
                    <p><b>Mot clef récurent :</b> <b class="data-passifs" data-passifs-name="Court"> Court</b>, <b class="data-passifs" data-passifs-name="Double"> Double</b>, <b class="data-passifs" data-passifs-name="Finesse"> Finesse</b>, coupant</p>
                    <br> 
                    <p><b>Maitrise : </b></p> 
                    <ul>
                        <li data-ability="Pas de l'ombre - Action Bonus"></li>
                    </ul>
                    
                    <br>
                    <p><b>Expertise : </b> </p>
                    <ul>
                        <li data-ability="Triple Coups"></li>
                        <li data-ability="Enchaînement sans fin"></li>
                    </ul>                       
                </div> 
                <div style="flex: 1 1 180px; min-width: 140px; text-align: center;">
                    <img src="../img/doublelames.png"
                        style="max-height: 380px; height: 100%; margin-top: 12px;">
                </div>               
            </div>
        </section>
        <div id="attack-tooltip" style="position:absolute; display:none; pointer-events:none; z-index:1000; max-width:300px; padding:8px; background:rgba(0,0,0,0.85); color:#fff; border-radius:5px; font-size:0.9em; box-shadow:0 0 5px #000;"></div>
    </div>
    <script>
        const tooltip = document.getElementById('attack-tooltip');
        const PATH_TO_ROOT = '../'; // car on est dans /Mecanique/ et les JSON sont à la racine

        function loadJSON(url) {
            console.log("Chargement JSON :", url);
            return fetch(url).then(res => {
                if (!res.ok) {
                    console.error(`❌ Erreur HTTP ${res.status} pour ${url}`);
                    return null;
                }
                return res.json();
            }).catch(err => {
                console.error(`❌ Erreur chargement ${url}`, err);
                return null;
            });
        }

        Promise.all([
            loadJSON(`${PATH_TO_ROOT}status.json`),
            loadJSON(`${PATH_TO_ROOT}ability.json`),
            loadJSON(`${PATH_TO_ROOT}passifs.json`)
        ])
        .then(([statusList, abilities, passifsList]) => {
            const statusData = {};
            const passifsData = {};

            // Charger les statuts
            if (statusList) {
                statusList.forEach(s => {
                    statusData[s.Nom.toLowerCase()] = s.description;
                });
            }

            // Charger les passifs
            if (passifsList) {
                passifsList.forEach(p => {
                    passifsData[p.Nom.toLowerCase()] = p.description;
                });
            }

            // Injecter abilities
            document.querySelectorAll('[data-ability]').forEach(el => {
                const abilityName = el.getAttribute('data-ability');
                const ability = abilities
                    ? abilities.find(a => a.Name.toLowerCase() === abilityName.toLowerCase())
                    : null;

                if (ability) {
                    el.innerHTML = `<b>${ability.Name}</b> : ${ability.description}`;
                } else {
                    el.textContent = abilityName;
                }
            });

            // Tooltips pour status
            if (statusList) {
                activateTooltips('.data-status', statusData);
            }

            // Tooltips pour passifs
            if (passifsList) {
                activateTooltips('.data-passifs', passifsData);
            }
        });

        function activateTooltips(selector, dataMap) {
            document.querySelectorAll(selector).forEach(el => {
                const attrName = selector === '.data-status' ? 'data-status-name' : 'data-passifs-name';
                const name = el.getAttribute(attrName) || el.textContent.trim();
                const desc = dataMap[name.toLowerCase()];

                if (desc) {
                    el.style.cursor = 'help';
                    el.style.textDecoration = 'underline dotted';
                    el.style.textDecorationThickness = '1px';
                    el.style.textUnderlineOffset = '2px';

                    el.addEventListener('mouseenter', () => {
                        tooltip.innerHTML = `<b>${name}</b><br>${desc}`;
                        tooltip.style.display = 'block';
                    });

                    el.addEventListener('mousemove', e => {
                        tooltip.style.left = (e.pageX + 10) + 'px';
                        tooltip.style.top = (e.pageY + 10) + 'px';
                    });

                    el.addEventListener('mouseleave', () => {
                        tooltip.style.display = 'none';
                    });
                } else {
                    console.warn(`⚠ Élément "${name}" non trouvé dans le JSON`);
                }
            });
        }
    </script>


</body>
</html>