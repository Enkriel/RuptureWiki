<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conjureur - Rupture JDR</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div id="navbar-container"></div>
    <script src="../navbar.js"></script>

    <div class="content-wrapper">
        <div class="header">
            <h1>Conjureur</h1>
            <p>Le Conjureur est un expert dans les armes magiques équipé d'un voir deux syntoniseurs il lance une déferlantes de comptétences sur le champs de batailles</p>
        </div>

        <div class="stats-section">
            <h2>Statistiques de base</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value">10</div>
                    <div class="stat-label">Évasion</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">6</div>
                    <div class="stat-label">PV</div>
                </div>
            </div>
            <h2>Maitrises</h2>
            <div class="mastery-list">
                <span class="mastery-item">1 Arme au choix</span>
            </div>
            <br>
            <h2>Équipement de départ</h2>
            <ul id="equipment-list">
                <li>Une Arme tier 0 au choix</li>
                <li>Une Armure tier 0 au choix</li>
                <li>un Syntoniseur tier 0 au choix</li>
                <li>2 Badges tier 1 au choix</li>
            </ul>
        </div>

        <!-- BOUTONS ARCHETYPE TOUJOURS VISIBLES -->
        <div class="archetype-buttons" id="archetype-buttons">
            <p>Choisissez un archétype pour débloquer ses capacités :</p>
            <button class="archetype-btn archetype-unique" data-archetype="unique">
                Les Manipulateurs <br><span>Les Manipulateurs utilisent 2 syntoniseurs </span><span>et consomme des badges pour améliorer et modifié leurs compétences</span>
            </button>
            <button class="archetype-btn archetype-meute" data-archetype="meute">                
                les Surchargées  <br><span>Les surchargées acculument après chaque sort de l'energie instable qu'ils peuvent relaché lors de leur attaques </span><span>ou prendre le risque de la conservé pour en augmenté la puissance </span>
            </button>
            <button class="archetype-btn archetype-pacte" data-archetype="pacte">
                Les Illusionistes<br><span>sont spécialisé dans les comptétence de corps à corps et crée des doubles d'eux-même ppour les aider au combats</span>
            </button>
        </div>

        <div class="level-progression" id="level-progression">
            <!-- Les niveaux et abilities seront générés ici -->
        </div>
    </div>
    <script>

    const levelAbilities = {
        1: [
            "Expertise Élémentaire", "Précision de l'Expert - Repos Court",
        ],
        2: [
            "Absorption - Réaction - Repos Court",
        ],
        4: [
            "Amélioration de Caractéristiques",
            "Amélioration Défensive"
        ],
        5: [
            "Expertise Élémentaire"
        ],
        6: [
            "Amélioration de Caractéristiques",
            "Amélioration Défensive",
            "Expertise Martiale"
        ],
        8: [
            "Amélioration de Caractéristiques",
            "Amélioration Défensive"
        ],
        9: [
            "Maîtrise Élémentaire"
        ],
        10: [
            "Expertise Libre"
        ]
    };

    const archetypeAbilities = {
        unique: {
            3: ["Expertise Élémentaire", "Double Syntoniseurs"],
            5: ["Fusion de Badges"],
            7: ["Recharge Élémentaire - Action Bonus - Repos Court"],
            10:["Avalanche Élémentaire - Repos Long"]
        },
        meute: {
            3: ["Charge", "Liaison Non magique", "Maîtrise d'arme"],
            5: ["Maintien", "Double Charge"],
            7: ["Charge NV6"],
            10: ["Charge instantanée - Action Bonus - Repos Long"]
        },
        pacte: {
            3: ["Spécialiste Magie Proche", "Matrise Armure Moyenne"],
            5: ["Illusion - Repos Court"],
            7: ["Ombre Vivante - Réaction"],
            10: ["Image Rémanente - Action Bonus - Repos Long"]
        }
    };

    function renderBaseLevels(abilityDescriptions) {
        const progression = document.getElementById("level-progression");
        progression.innerHTML = "";

        [1,2,3,4,5,6,7,8,9,10].forEach(level => {
            const card = document.createElement("div");
            card.className = "level-card";
            card.dataset.level = level;
            card.innerHTML = `
                <div class="level-header">
                    <div class="level-number">Level ${level}</div>
                </div>
                <ul class="ability-list"></ul>
            `;
            const ul = card.querySelector(".ability-list");
            (levelAbilities[level] || []).forEach(name => {
                const desc = abilityDescriptions[name] || "";
                ul.innerHTML += `
                    <li class="ability-item">
                        <div class="ability-name">${name}</div>
                        <div class="ability-description">${desc}</div>
                    </li>
                `;
            });
            progression.appendChild(card);
        });
    }

    function applyArchetype(archetype, abilityDescriptions) {
        // Pour chaque niveau d'archétype
        Object.keys(archetypeAbilities[archetype]).forEach(levelStr => {
            const level = parseInt(levelStr);
            // Trouve la carte de niveau correspondante
            const card = document.querySelector(`.level-card[data-level="${level}"]`);
            if (!card) return;
            const ul = card.querySelector(".ability-list");
            // Supprime les anciennes abilities d'archétype (pour changer d'archétype)
            ul.querySelectorAll(".arch").forEach(el => el.remove());
            // Ajoute les abilities d'archétype
            archetypeAbilities[archetype][level].forEach(name => {
                const desc = abilityDescriptions[name] || "";
                const li = document.createElement("li");
                li.className = `ability-item arch ${archetype}`;
                li.innerHTML = `
                    <div class="ability-name ability-name-${archetype}">${name}</div>
                    <div class="ability-description">${desc}</div>
                `;
                ul.appendChild(li);
            });
        });
    }

    fetch('../ability.json')
    .then(res => res.json())
    .then(data => {
        const abilityDescriptions = {};
        data.forEach(ability => {
            if (ability.Name) abilityDescriptions[ability.Name.trim()] = ability.description;
        });

        renderBaseLevels(abilityDescriptions);

        document.querySelectorAll(".archetype-btn").forEach(btn => {
            btn.addEventListener("click", () => {
                document.querySelectorAll(".archetype-btn").forEach(b => b.classList.remove("active"));
                btn.classList.add("active");

                // NE PAS rappeler renderArchLevels ici !
                const archetype = btn.dataset.archetype;
                applyArchetype(archetype, abilityDescriptions);
            });
        });
    });
    </script>
</body>
</html>