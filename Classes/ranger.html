<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ranger - Rupture JDR</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div id="navbar-container"></div>
    <script src="../navbar.js"></script>

    <div class="content-wrapper">
        <div class="header">
            <h1>Ranger</h1>
            <p>Maître du dressage et des liens avec les Pokémon</p>
        </div>

        <div class="stats-section">
            <h2>Statistiques de base</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value">10</div>
                    <div class="stat-label">Évasion</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">6</div>
                    <div class="stat-label">PV</div>
                </div>
            </div>

            <h2>Maitrises</h2>
            <div class="mastery-list">
                <span class="mastery-item">Fouet</span>
                <span class="mastery-item">Armure Légère</span>
                <span class="mastery-item">Armure Moyenne</span>
            </div>
            <br>
            <h2>Équipement de départ</h2>
            <ul id="equipment-list">
                <li>Un starter parmi 3 selon les maîtrises élémentaires</li>
                <li>Un Fouet tier 0 au choix</li>
                <li>Une Armure tier 0 au choix</li>
                <li>Des jumelles</li>
                <li>un Pokedex</li>
            </ul>
        </div>

        <!-- BOUTONS ARCHETYPE TOUJOURS VISIBLES -->
        <div class="archetype-buttons" id="archetype-buttons">
            <p>Choisissez un archétype pour débloquer ses capacités :</p>
            <button class="archetype-btn archetype-unique" data-archetype="unique">
                Lien Unique <br><span>Se concentrer sur un seul Pokémon puissant</span>
            </button>
            <button class="archetype-btn archetype-meute" data-archetype="meute">
                Lien de la Meute <br><span>Submerger l’ennemi avec plusieurs Pokémon</span>
            </button>
            <button class="archetype-btn archetype-pacte" data-archetype="pacte">
                Lien du Pacte <br><span>Créer des pactes temporaires avec des Pokémon sauvages</span>
            </button>
        </div>

        <div class="level-progression" id="level-progression">
            <!-- Les niveaux et abilities seront générés ici -->
        </div>
    </div>
    <script>
    // filepath: c:\Users\arthu\Documents\GitHub\RuptureWiki\Classes\ranger.html

    const levelAbilities = {
        1: [
            "Étude",
            "Ordre Simple"
        ],
        2: [
            "Don de Déplacement - Action de Déplacement et Action Bonus",
            "Soin Pokémon - Action Bonus - Repos Court"
        ],
        4: [
            "Amélioration de Caractéristiques",
            "Amélioration Défensive"
        ],
        5: [
            "Expertise Élémentaire"
        ],
        6: [
            "Amélioration de Caractéristiques",
            "Amélioration Défensive",
            "Expertise Martiale"
        ],
        8: [
            "Amélioration de Caractéristiques",
            "Amélioration Défensive"
        ],
        9: [
            "Connexion Totale"
        ],
        10: [
            "Expertise Libre"
        ]
    };

    const archetypeAbilities = {
        unique: {
            3: ["Slot Basique", "Ordre Complexe"],
            5: ["Diversité"],
            7: ["Plein Potentiel - Repos Long"],
            10: ["Slot Puissant"]
        },
        meute: {
            3: ["Double Slot"],
            5: ["Attaque sur Plusieurs Flancs"],
            7: ["Slot Basique Supplémentaire", "Placement de la Meute"],
            10: ["Attaque Unisson"]
        },
        pacte: {
            3: ["Pacte", "Appel", "Dresseur sans Fouet"],
            5: ["Sifflement Sauvage"],
            7: ["Pacte de la Zone"],
            10: ["Rugissement du roi"]
        }
    };

    function renderBaseLevels(abilityDescriptions) {
        const progression = document.getElementById("level-progression");
        progression.innerHTML = "";

        [1,2,3,4,5,6,7,8,9,10].forEach(level => {
            const card = document.createElement("div");
            card.className = "level-card";
            card.dataset.level = level;
            card.innerHTML = `
                <div class="level-header">
                    <div class="level-number">Level ${level}</div>
                </div>
                <ul class="ability-list"></ul>
            `;
            const ul = card.querySelector(".ability-list");
            (levelAbilities[level] || []).forEach(name => {
                const desc = abilityDescriptions[name] || "";
                ul.innerHTML += `
                    <li class="ability-item">
                        <div class="ability-name">${name}</div>
                        <div class="ability-description">${desc}</div>
                    </li>
                `;
            });
            progression.appendChild(card);
        });
    }

    function applyArchetype(archetype, abilityDescriptions) {
        // Pour chaque niveau d'archétype
        Object.keys(archetypeAbilities[archetype]).forEach(levelStr => {
            const level = parseInt(levelStr);
            // Trouve la carte de niveau correspondante
            const card = document.querySelector(`.level-card[data-level="${level}"]`);
            if (!card) return;
            const ul = card.querySelector(".ability-list");
            // Supprime les anciennes abilities d'archétype (pour changer d'archétype)
            ul.querySelectorAll(".arch").forEach(el => el.remove());
            // Ajoute les abilities d'archétype
            archetypeAbilities[archetype][level].forEach(name => {
                const desc = abilityDescriptions[name] || "";
                const li = document.createElement("li");
                li.className = `ability-item arch ${archetype}`;
                li.innerHTML = `
                    <div class="ability-name ability-name-${archetype}">${name}</div>
                    <div class="ability-description">${desc}</div>
                `;
                ul.appendChild(li);
            });
        });
    }

    fetch('../ability.json')
    .then(res => res.json())
    .then(data => {
        const abilityDescriptions = {};
        data.forEach(ability => {
            if (ability.Name) abilityDescriptions[ability.Name.trim()] = ability.description;
        });

        renderBaseLevels(abilityDescriptions);

        document.querySelectorAll(".archetype-btn").forEach(btn => {
            btn.addEventListener("click", () => {
                document.querySelectorAll(".archetype-btn").forEach(b => b.classList.remove("active"));
                btn.classList.add("active");

                // NE PAS rappeler renderArchLevels ici !
                const archetype = btn.dataset.archetype;
                applyArchetype(archetype, abilityDescriptions);
            });
        });
    });
    </script>
</body>
</html>